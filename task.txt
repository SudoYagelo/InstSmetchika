Вывод результата из формы "Обработка спецификации"	
Где: Функционал выгрузки результатов в Excel

Что: Выгрузка результатов в Excel должна сохранять иерархическую структуру входной формы

Текущая логика системы:

Система корректно преобразует иерархическую структуру входной формы в плоский вид для внутренней обработки:

Уровень 1  → колонка «Объект строительства» (например, "Корпус 18.1.1")
Уровень 2  → колонка «Помещение» (например, "Общеобменная вентиляция МОП")
Уровень 3  → колонка «Тип» (например, "В2.1")
Уровень 4 → «Наименование позиции» (конкретные материалы/оборудование)
Фактическое поведение:

При выгрузке в Excel система выгружает обработанные данные в плоском табличном виде:

Все данные выводятся без иерархической структуры
Отсутствуют строки-заголовки для разделов (Объект, Помещение, Тип)
Структура входной формы не восстанавливается

 

Требуемое поведение:

При выгрузке обработанной спецификации в Excel система должна:

Распознать иерархические уровни из колонок «Объект строительства», «Помещение», «Тип» в форме проверки (плоской обработанной форме)
Восстановить исходную структуру входной формы:
Создать строку для уровня 1 (Объект строительства) — значение выводится в колонку C «Поз.»
Создать строку для уровня 2 (Помещение) — значение выводится в колонку B «Поз.»
Создать строку для уровня 3 (Тип) — значение выводится в колонку B «Поз.»
Вывести позиции материалов на уровне 4 — данные распределяются по колонкам B-V
Заполнить данные: Для строк уровней 1-3 (заголовки разделов):
Колонка A «№ п/п»: сквозная нумерация
Колонка B «Поз.»: значение соответствующего уровня (Объект строительства)
Колонка C «Поз.»: значение соответствующего уровня (Помещение / Тип)
Колонки D-V: остаются пустыми
Для строк уровня 4 (позиции материалов):
Колонка A «№ п/п»: сквозная нумерация
Колонки B-H: данные из входной формы
B: Поз.
C: Наименование позиции спецификации
D: Техническая характеристика
E: Код изделия
F: Завод, код изделия
G: Ед.изм
H: Количество
Колонки I-V: данные из формы проверки (плоской обработанной формы)
I: Код статьи
J: Кодификатор КВР
K: Вид работы наименование
L: КВР
M: Код головной номенклатуры
N: Головная номенклатура (ССОМ)
O: Ед.изм КВР
P: Коэффициент пересчета
Q: Количество с коэффициентом пересчета
R: Цена работ (БЕЗ НДС)
S: Стоимость прочих материалов
T: Цена индикатив
U: Уверенность
V: Примечание
Связывание данных между входной формой и формой проверки выполняется по комбинации колонок (теоретически?):
Наименование позиции спецификации
Техническая характеристика
Тип, марка, обозначение документа, опросного листа
Код изделия
Завод-изготовитель
Единица измерения
